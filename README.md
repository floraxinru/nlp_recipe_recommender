## [NLP] Recipe Recommender

This is my 4th project at Metis Data Science. It is a 2-week project using NLP, unstructured data, and unsupervised learning.

### Summary

For this 2-week project, I built a working recommendation system for recipes, based on topics from NLP. I also wanted to make a working Flask app to get a usable product at the end. Although I did not get to the Flask app, I was happy with the recommendation results from my model. I also had to make some important design decisions in deciding which datasets and tools to use to best achieve my goals. I would like to continue working on this project in the near future.

### Motivation

> *Have you ever wanted to try a new menu item when eating out, or cook a new dish at home, but unsure if you’d like it?*

Trying out a new recipe, especially one from another culture, can be risky. You probably won’t want to invest in expensive exotic ingredients on your first try. What if you can take a small step, and try out a dish from another cuisine with basic ingredients from a recipe you know and love?

I would like to make a tool to help fellow foodies and travellers like me discover recipes they might enjoy from other cultures more easily. They could use it to order their meals when trying out a foreign restaurant, with more confidence that they will like the dish ordered. This tool can also help add more variety and excitement for cooking with a few basic ingredients at home.

With meal kit delivery systems such as Blue Apron and Hellofresh becoming more popular, an ingredient-based recipe recommender can help users switch out recipes they don’t like, and try new recipes with the same ingredients delivered to them.

### Data

Since recipes are time-insensitive, I used downloaded data previously scraped and uploaded by others. My main data source is recipe box (https://eightportions.com/datasets/Recipes/#fn:1), which has ~125,000 scraped recipes from food websites (Foodnetwork.com, Epicurious.com, and Allrecipes.com). The dataset is 50.9MB, in JSON format. Each recipe entry contains a recipe title, a list of ingredients and measurements, instructions for preparation, and many also have a picture of the resulting dish.

Although the Kaggle What’s Cooking (https://www.kaggle.com/c/whats-cooking/data) dataset is the smallest and cleanest food dataset I’ve found (and initially seems great for an mvp), it does not have names for recipes. The only features are recipe ids, cuisine types, and ingredients (The source for that data (Yummly.com) has an API but it shut down in September). But because it comes with pre-labelled cuisine types which “recipe box” lacks, I still used it for the initial exploratory data analysis and MVP.

### Tools

- Python, pandas, NumPy, SciPy, scikit-learn, pickle
- Matplotlib, Seaborn, Tableau
- NLTK, Gensim
- GitHub, cookiecutter (datasciencemvp template)
- AWS, Jupyter Notebook, Visual Studio Code

### Results

Results are summarized in my PDF slides for my 4-minute presentation (project4slides_final.pdf). I showcased three randomly selected recipe titles, and the top three recommendations for each. The presentation also included a short video of my Jupyter Notebook when I tested the recommender on new data from a different website.

  - It was promising to see that, for the recipe "Awesome Slow Cooker Pot Roast" one of the top recommendations from my model was "Slow Cooker London Broil", which was also one of the top recommendations displayed on the allrecipes webpage for the pot roast recipe. 
  - The model could definitely still use improvement, as its top 3 recommendations for a Steak Tacos recipe included a nachos dish, a tacos dish, but also a Thai-style curry noodle dish. 
  
Because this is unsupervised learning, we can't pinpoint exactly how the model reached such recommendations, or measure some sort of accuracy as in supervised learning. But we can still make a human judgement about how relevant the recommendations are (especially when reading through the topics generated by LSA and NMF), so the results can still be helpful. It was also quite a fun process, getting some really relevant results as well as some surprising ones.


### Design Decisions

Because this was my first unsupervised learning project with a self-defined goal, I had to pause at several instances to reconsider whether the tools I was about to apply were really helpful in solving the problem and enhancing the data story. This proved beneficial, as my data story flowed well during presentation. If I had included Kmeans clustering results that don't relate to my topic modelling results, it would have been distracting and perhaps confusing for the audience.

I spent longer cleaning the RecipeBox data than expected. Since I wanted to test out the NLP tools we learned, as well as get a finished minimum viable product on time, I made the mvp using the smaller, cleaner recipe box dataset instead. This helped me get a good sense of what the topics look like after dimensionality reduction, and was helpful when comparing results from different models later applied to the larger dataset.

I was aware from the beginning that my goals for the project were ambitious. And even though I had almost 2 days allotted for learning to make my first Flask app as planned, I decided against it, and focused on cleaning the code and practicing my presentation instead. I am also less interested in web development compared to data analysis, and decided optimizing my model and interpreting the results should take priority over making a basic web app purely for demonstration purposes (see future work).


### Future Work
(November 17, 2019)

The next step of this project is to continue improving the recommendation results with the current model (TF-IDF + LSA) by doing more thorough preprocessing (trying different stemmers and lemmatizers, perhaps using SpaCy), and training it on more data. I also want to use Gensim and see if LDA gives better recommendations than LSA. 

I would like to scrape another recipe website such as BBCfood. I can then use some of that data as the test data, and the rest to increase the training dataset. 

Then the next step would be to develop a simple Flask app, with interactive elements (such as a search bar with potential recipes to start from based on keywords typed in by the user, a button to click on to get recommendations, and displaying recommendations in a neat format. 
Another step beyond that would be to cluster the topics to see if the clusters match cuisine types. 

Building a cuisine type classifier using the smaller What’s Cooking dataset would also be useful. Then I can predict cuisine types for recipes in the large dataset, and compare that with how they cluster. It will also help to have metrics from supervised learning after generating recommendations in unsupervised learning, to know how good the results are, and when to stop optimizing.

(I worked on a separate project, Pic-a-recipe, as my Capstone project, and built a Flask app for that. See pinned repo on Overview page.)

